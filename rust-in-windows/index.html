<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <style>
      :root {
        --accent-color: #05a081;
        --accent-color-light: #82d0c0;
      }
    </style>

    <meta name="theme-color" content="#05a081" />

    
      <link rel="icon" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;444e76059742f47b00.png" />
      <link rel="apple-touch-icon" sizes="48x48" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;444e76059742f47b00.png" />
      <link rel="apple-touch-icon" sizes="72x72" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;6dfeb9b0bd094d5a00.png" />
      <link rel="apple-touch-icon" sizes="96x96" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;3959b3b31b7ae92700.png" />
      <link rel="apple-touch-icon" sizes="144x144" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;e644b27af091684500.png" />
      <link rel="apple-touch-icon" sizes="192x192" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;3344ee474c2d849c00.png" />
      <link rel="apple-touch-icon" sizes="256x256" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;d92103ca49c6bd5e00.png" />
      <link rel="apple-touch-icon" sizes="384x384" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;b8dd2689e662c9cd00.png" />
      <link rel="apple-touch-icon" sizes="512x512" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;c0d9496000275d3400.png" />
    

    

    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary">

    

    

    
      
        <meta name="description" content="" />
        <meta name="twitter:description" content="">
      
    

    
      <meta name="twitter:title" content="Using Rust in Windows">
    

    
      <link rel="prerender" href="&#x2F;" />
    
      <link rel="prerender" href="&#x2F;tags" />
    
      <link rel="prerender" href="https:&#x2F;&#x2F;www.twitter.com&#x2F;jntrnr" />
    
      <link rel="prerender" href="&#x2F;atom.xml" />
    
      <link rel="prerender" href="&#x2F;poems&#x2F;waitingtogrow" />
    

    <link rel="prefetch" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;53af5229a2f8852200.png" />

    <title>
      
        
          Using Rust in Windows
        
      
    </title>

    
    
      <link rel="stylesheet" href="https://www.jntrnr.com/main.css">
    
    
  
    <link rel="prerender" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;rls-alpha-2&#x2F;">
  

  
    <link rel="prerender" href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;rls-now-in-nightly&#x2F;">
  

  
    <link rel="prerender"  href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;tags&#x2F;rust&#x2F;">
  

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://google.com/article"
      },
      "headline": "Using Rust in Windows",
      "image": [],
      "datePublished": "2017-03-28T00:00:00+00:00",
      "dateModified": "2017-03-28T00:00:00+00:00",
      "author": {
        "@type": "Person",
        "name": "JT"
      },
       "publisher": {
        "@type": "Organization",
        "name": "JT",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.jntrnr.com/icon.png"
        }
        
      }
      
    }
  </script>

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        

        
        {
          
          "@type": "ListItem",
          "position": 1,
          "name": "",
          "item": "https://www.jntrnr.com/"
        },
        
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Using Rust in Windows",
          "item": "https://www.jntrnr.com/rust-in-windows/"
        }
      ]
    }
  </script>

  </head>
  <body>
    
      <header>
        <a class="profile-icon" href="/">
          <img src="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;processed_images&#x2F;53af5229a2f8852200.png" alt="profile picture">
        </a>
        <nav>
          
            <a href="&#x2F;">Home</a>
          
            <a href="&#x2F;tags">Tags</a>
          
            <a href="https:&#x2F;&#x2F;www.twitter.com&#x2F;jntrnr">Twitter</a>
          
            <a href="&#x2F;atom.xml">Atom&#x2F;RSS</a>
          
            <a href="&#x2F;poems&#x2F;waitingtogrow">Poems</a>
          
        </nav>
      </header>
    
    <main>
    
  <div class="post-title">
    <h1>Using Rust in Windows</h1>
    <small>
      March 28, 2017
      
        - 
        <span class="tags">
          
            <a href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;tags&#x2F;rust&#x2F;">rust</a>
          
        </span>
      
    </small>
  </div>

  <div>
    <p>As a Rust user, I was discouraged by not having all the good tips for using Rust in Windows in one place.  This is an attempt to just that.  If you have more tips tweet them to @jntrnr, and I'll try to add them here.</p>
<h1 id="getting-started">Getting started</h1>
<h2 id="step-1-install-visual-studio-community-edition">Step 1: Install Visual Studio Community edition</h2>
<p>My recommendation for working with Rust in Windows is to first get <a href="https://www.visualstudio.com/downloads/">Visual Studio 2017 Community</a> installed.  <em>Edit:</em> Make sure you check the boxes to install <strong>C++ support</strong> when you instal Visual Studio, this provides the linker. The Rust compiler will use the linker that VS provides to translate our Rust code all the way to being an application.  Having VS installed pays off in more ways than one, as we'll see later.</p>
<h2 id="step-2-install-rustup">Step 2: Install rustup</h2>
<p>The Rust toolchain (including the compiler and the <code>cargo</code> build tool) are managed by a tool called <a href="https://rustup.rs/">rustup</a>.  This is the easiest way get going with Rust.  It also has a few advantages, like allowing you to more easily switch the style of compiler (stable/beta/nightly) as well as building for other targets, like embedded systems.</p>
<p>Once Visual Studio is installed, rustup will detect it and let us install the compiler that works with the VS toolchain.  Rustup on the initial install will let you pick the compiler, and you can select working with nightly or release.  What you choose is up to you.  Nightly gives you access to new features but hasn't been tested as thoroughly as the stable release compiler.</p>
<p>Whether you choose Nightly or Stable, you'll have commands available to you at the terminal.  You won't need a separate shell to get to them.  The commands 'rustc' and 'cargo' are the Rust compiler and Rust package manager respectively. </p>
<h2 id="step-3-make-sure-everything-is-working">Step 3: Make sure everything is working</h2>
<p>In a source directory, you can test if Rust has been installed correctly by creating a simple project, compiling it, and running it.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">cargo new hello_world --bin
cd hello_world
cargo run (or &quot;cargo build&quot; followed by &quot;cargo run&quot;)
</span></code></pre>
<p>You can find out lots of helpful general <a href="https://doc.rust-lang.org/book/getting-started.html">getting started tips</a> in the Rust documentation.</p>
<h1 id="writing-rust-code-in-windows">Writing Rust Code in Windows</h1>
<p>Currently, IDE support for Rust is still in its infancy.  If you don't need fully intellisense-style IDE experience, pretty much all editors now have basic Rust support.  Pick your favorite one, install their Rust plugin or syntax highlighter, and you're good to go.  Many of these plugins come with support for a project called 'racer', which provides an autocompletion.  Visual Studio users may be interested in <a href="https://marketplace.visualstudio.com/items?itemName=vosen.VisualRust">Visual Rust</a>.</p>
<p>For the more daring, there's a project called the <a href="https://github.com/rust-lang-nursery/rls">Rust Language Server</a>, which is based on the <a href="https://github.com/Microsoft/language-server-protocol/blob/master/protocol.md">Language Server Protocol</a> developed for VS Code and now part of a growing number of editors and IDEs.</p>
<p>You can find steps for how to set up the RLS and use it with VS Code on its <a href="https://github.com/rust-lang-nursery/rls/blob/master/README.md">readme</a>.  That said, the RLS is still pre-beta quality as of the writing of this post, so please exercise caution if you go this route.</p>
<h1 id="debugging-with-visual-studio">Debugging with Visual Studio</h1>
<p>Earlier we installed Visual Studio.  It seems a waste to have this nice VS install sitting around and not getting more benefit from it it.  Let's use it for debugging.</p>
<p>Before we do some debugging, there are two steps we'll want to do beforehand:</p>
<h2 id="step-1-install-rust-src">Step 1: Install rust-src</h2>
<p>When we're debugging, VS will sometimes complain because it can't find the source code to the standard libs.  We can remove this announce by installing the rust-src, and helping VS find the source it's looking for (this is also a helpful step for <code>racer</code> support)</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">rustup component add rust-src
</span></code></pre>
<p>This will let you find the source to the standard libs when you're debugging.  After the command is run, it will be put in your .multirust directory.  For me that directory is:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">C:\Users\Jonathan Turner\.multirust\toolchains\nightly-x86_64-pc-windows-msvc\lib\rustlib\src\rust\src
</span></code></pre>
<p>When Visual Studio asks you for a file from the standard library source, this should give you a good place to start looking for it.</p>
<h2 id="step-2-add-natvis-for-rust">Step 2: Add natvis for Rust</h2>
<p>Rust has its own common structs, like String and Vec, that Visual Studio won't understand by default currently.  To be able to view these data structures, we use native visualisation or .natvis files.  Rustup will helpfully make them available for us, we just have to copy them into our personal directory.  For me, the .natvis files are in:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">C:\Users\Jonathan Turner\.multirust\toolchains\nightly-x86_64-pc-windows-msvc\lib\rustlib\src\rust\src\etc\natvis
</span></code></pre>
<p>NOTE: you may need to install the <code>nightly</code> toolchain to have this directory.  You don't need to use the nightly compiler as your main compiler, though, to take advantage of them.</p>
<p>I copy these files into:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">C:\Users\Jonathan Turner\Documents\Visual Studio 2017\Visualizers
</span></code></pre>
<p>If you don't have a <code>Visualizers</code> directory, go ahead and create it and then copy the files into it.  Once you start up VS, it should pick them up and give you a little better view of your Rust data.</p>
<p>With that, debugging a Rust app works very similar to debugging other apps.  There are a few steps you need to do:</p>
<ul>
<li>Compile your projects with debug info.  The easiest way is to build using <code>cargo build</code> and NOT <code>cargo build --release</code>.</li>
<li>Run your application</li>
<li>Attach the VS debugger using the 'Attach...' feature.  You should be able to find your application in the list.  Once you attach, you can hit pause, set breakpoints, and step as normal.</li>
</ul>
<h1 id="debugging-with-vscode-and-msvc">Debugging with VSCode and MSVC</h1>
<p>You can also setup vscode as your development and debugging platform.  There are some good tips on how to do this in <a href="https://www.brycevandyk.com/debug-rust-on-windows-with-visual-studio-code-and-the-msvc-debugger/">this blog post</a>.</p>
<h1 id="conclusion">Conclusion</h1>
<p>There is still plenty of room for improvement, but already there's enough here that we can write, build, and debug Rust applications without too much fuss.  The Rust teams are working to continue to improve the experience of developing in Windows on Rust, but it's encouraging to see the progress and where it could go in the future.</p>

  </div>

  <hr class="footer-rule" />

  
    <div class="footer-about">
      <p>A simple dev-blog theme created by Bennett. You can follow him on <a href="https://github.com/bennetthardwick">Github</a> (if you like).</p>

    </div>
  

  <div class="related-container">

    
      <div class="link">
        Previous <br />
        <a href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;rls-alpha-2&#x2F;">Rust Language Server Alpha 2 Release</a>
      </div>
    

    
      <div class="link">
        Next <br />
        <a href="https:&#x2F;&#x2F;www.jntrnr.com&#x2F;rls-now-in-nightly&#x2F;">RLS now available on nightly</a>
      </div>
    

  </div>


    </main>
  </body>
</html>
